<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CIPHERPHANTOM Owner Tools</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="wrap">
    <header class="head">
      <pre class="brandbox">+-----------------------------+
|     CIPHERPHANTOM OWNER    |
+-----------------------------+</pre>
    </header>

    <section id="loginCard" class="card">
      <h2>Owner Login</h2>
      <p class="muted">Willkommen im CIPHERPHANTOM Owner Panel.</p>
      <input id="username" type="text" placeholder="Username" autocomplete="username" />
      <input id="password" type="password" placeholder="Passwort" autocomplete="current-password" />
      <button id="loginBtn">Einloggen</button>
      <p id="loginMsg" class="msg"></p>
    </section>

    <section id="appCard" class="card hidden appCard">
      <div class="topbar">
        <div class="brandLine">
          <div class="brandMark" aria-hidden="true">CP</div>
          <div class="topbarText">
            <h2 class="topTitle">Owner Kontrollzentrale</h2>
            <p class="muted">Verwaltung von Bot, App, Datenbank und Server in einer Oberfläche.</p>
          </div>
        </div>
        <button id="menuToggle" class="iconBtn" aria-label="Menü öffnen">☰</button>
      </div>

      <div id="menuBackdrop" class="menuBackdrop hidden"></div>

      <div class="appShell">
        <aside id="menuDrawer" class="menu menuDrawer">
          <button id="menuClose" class="iconBtn menuCloseBtn" aria-label="Menü schließen">✕</button>
          <div class="menuHead menuBrand">
            <strong>Kontrollzentrale</strong>
            <span>Owner Navigation</span>
          </div>

          <details class="menuSection" open>
            <summary>Leitzentrale</summary>
            <div class="menuSub">
              <button data-tab="info">Live-Übersicht</button>
              <button data-tab="admin">Server-Steuerung</button>
              <button data-tab="appctl">App-Steuerung</button>
              <button data-tab="forge">Command Forge</button>
            </div>
          </details>

          <details class="menuSection" open>
            <summary>Datenbereich</summary>
            <div class="menuSub">
              <button data-tab="db">Daten-Explorer</button>
              <button data-tab="dbform">Daten-Editor</button>
              <button data-tab="outbox">Outbox-Warteschlange</button>
              <button data-tab="dbinsight">Schema-Radar</button>
              <button data-tab="dbexport">Export-Studio</button>
            </div>
          </details>

          <details class="menuSection">
            <summary>Bot Hub</summary>
            <div class="menuSub">
              <button data-tab="botctl">Bot-Steuerung</button>
              <button data-tab="msg">Direktnachricht</button>
              <button data-tab="broadcast">Broadcast-Zentrale</button>
              <button data-tab="botcomposer">Template-Studio</button>
              <button data-tab="botlookup">Empfänger-Check</button>
            </div>
          </details>

          <details class="menuSection">
            <summary>Sicherheit</summary>
            <div class="menuSub">
              <button data-tab="ban">Sperrverwaltung</button>
              <button data-tab="profile">Owner Profil</button>
            </div>
          </details>

          <div class="menuSection menuSectionFlat">
            <button id="logoutBtn" class="danger">Logout</button>
          </div>
        </aside>

        <main class="panelArea">
          <div id="tab-db" class="tab hidden">
            <h3>Daten-Explorer</h3>
            <p class="tabLead">Tabellen filtern, durchsuchen und schnell analysieren.</p>
            <section class="sectionCard">
              <div class="row">
                <select id="tableSelect"></select>
                <input id="dbSearchInput" type="text" placeholder="Suche in Tabelle..." />
                <input id="limitInput" type="number" min="1" max="500" value="50" />
                <button id="loadTableBtn">Laden</button>
              </div>
            </section>
            <p id="dbMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="tableWrap" class="tableWrap"></div>
            </section>
          </div>

          <div id="tab-dbform" class="tab hidden">
            <h3>Daten-Editor</h3>
            <p class="tabLead">Datensätze über Felder lesen, anlegen, aktualisieren oder löschen.</p>
            <section class="sectionCard">
              <div class="row">
                <select id="dbFormTableSelect"></select>
                <input id="dbFormRowIdInput" type="number" min="1" placeholder="Row-ID (optional)" />
                <button id="dbFormLoadBtn">Laden</button>
              </div>
              <div id="dbFormFields" class="row2"></div>
              <div class="row">
                <button id="dbFormCreateBtn">Hinzufügen</button>
                <button id="dbFormUpdateBtn">Speichern</button>
                <button id="dbFormDeleteBtn" class="danger">Löschen</button>
              </div>
            </section>
            <p id="dbFormMsg" class="msg"></p>
          </div>

          <div id="tab-ban" class="tab hidden">
            <h3>Sperrverwaltung</h3>
            <p class="tabLead">Nutzer sperren, entsperren und Sperrlisten prüfen.</p>
            <section class="sectionCard">
              <div class="row2">
                <input id="banPhone" type="text" placeholder="Handynummer (z. B. 49176...)" />
                <input id="banDuration" type="number" min="0" placeholder="Dauer in Stunden (0 = permanent)" />
                <input id="banReason" type="text" placeholder="Grund" />
              </div>
              <div class="row">
                <button id="banBtn" class="danger">Bannen</button>
                <button id="unbanBtn">Entsperren</button>
                <button id="loadBansBtn">Sperrliste laden</button>
              </div>
            </section>
            <p id="banMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="bansWrap" class="tableWrap"></div>
            </section>
          </div>

          <div id="tab-msg" class="tab hidden">
            <h3>Direktnachricht</h3>
            <p class="tabLead">Einzelne Nachricht direkt an eine Zielnummer senden.</p>
            <section class="sectionCard">
              <div class="row2">
                <input id="msgPhone" type="text" placeholder="Handynummer (z. B. 49176...)" />
                <input id="msgText" type="text" placeholder="Nachricht an die Nummer" />
              </div>
              <div class="row">
                <button id="sendMsgBtn">Nachricht senden</button>
              </div>
            </section>
            <p id="msgToolMsg" class="msg"></p>
          </div>

          <div id="tab-broadcast" class="tab hidden">
            <h3>Broadcast-Zentrale</h3>
            <p class="tabLead">Nachricht an User, Gruppen oder beide Zielgruppen senden.</p>
            <section class="sectionCard">
              <div class="row2">
                <select id="broadcastScope">
                  <option value="users">Alle User</option>
                  <option value="groups">Alle Gruppen</option>
                  <option value="all">User + Gruppen</option>
                </select>
                <input id="broadcastText" type="text" placeholder="Broadcast-Nachricht" />
              </div>
              <div class="row">
                <button id="sendBroadcastBtn" class="danger">Broadcast senden</button>
              </div>
            </section>
            <p id="broadcastMsg" class="msg"></p>
          </div>

          <div id="tab-botcomposer" class="tab hidden">
            <h3>Template-Studio</h3>
            <p class="tabLead">Wiederverwendbare Broadcast-Vorlagen speichern, laden und direkt senden.</p>
            <section class="sectionCard">
              <div class="row">
                <input id="botTplNameInput" type="text" placeholder="Vorlagenname" />
                <select id="botTplSelect"></select>
                <button id="botTplLoadBtn">Laden</button>
                <button id="botTplSaveBtn">Speichern</button>
                <button id="botTplDeleteBtn" class="danger">Löschen</button>
              </div>
              <div class="row">
                <select id="botTplScopeSelect">
                  <option value="users">Alle User</option>
                  <option value="groups">Alle Gruppen</option>
                  <option value="all">User + Gruppen</option>
                </select>
              </div>
              <textarea id="botTplTextInput" rows="5" placeholder="Vorlagentext für Broadcast"></textarea>
              <div class="row">
                <button id="botTplSendBtn">Vorlage senden</button>
              </div>
            </section>
            <p id="botComposerMsg" class="msg"></p>
          </div>

          <div id="tab-outbox" class="tab hidden">
            <h3>Outbox-Warteschlange</h3>
            <p class="tabLead">Versandstatus und Fehler in der Nachrichtenwarteschlange überwachen.</p>
            <section class="sectionCard">
              <div class="row">
                <select id="outboxStatus">
                  <option value="all">Alle</option>
                  <option value="pending">Pending</option>
                  <option value="sent">Sent</option>
                  <option value="failed">Failed</option>
                </select>
                <input id="outboxLimit" type="number" min="1" max="500" value="100" />
                <button id="loadOutboxBtn">Aktualisieren</button>
              </div>
            </section>
            <p id="outboxMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="outboxWrap" class="tableWrap"></div>
            </section>
          </div>

          <div id="tab-dbinsight" class="tab hidden">
            <h3>Schema-Radar</h3>
            <p class="tabLead">Schnellanalyse der Datenstruktur und Datenqualität über alle Tabellen.</p>
            <section class="sectionCard">
              <div class="row">
                <input id="dbInsightSampleInput" type="number" min="10" max="500" value="150" placeholder="Sample pro Tabelle" />
                <input id="dbInsightTablesInput" type="number" min="1" max="100" value="20" placeholder="Max. Tabellen" />
                <button id="dbInsightRefreshBtn">Radar starten</button>
              </div>
            </section>
            <p id="dbInsightMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="dbInsightCardsWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <div id="dbInsightTableWrap" class="tableWrap"></div>
            </section>
          </div>

          <div id="tab-dbexport" class="tab hidden">
            <h3>Export-Studio</h3>
            <p class="tabLead">Tabellen in JSON oder CSV exportieren, prüfen und direkt herunterladen.</p>
            <section class="sectionCard">
              <div class="row">
                <select id="dbExportTableSelect"></select>
                <select id="dbExportFormatSelect">
                  <option value="json">JSON</option>
                  <option value="csv">CSV</option>
                  <option value="excel">Excel (.xls)</option>
                </select>
                <input id="dbExportMaxRowsInput" type="number" min="1" max="5000" value="1500" placeholder="Max. Zeilen" />
                <button id="dbExportPreviewBtn">Vorschau</button>
                <button id="dbExportDownloadBtn">Download</button>
              </div>
            </section>
            <p id="dbExportMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="dbExportMetaWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <div id="dbExportPreviewWrap" class="logsBox"></div>
            </section>
          </div>

          <div id="tab-botctl" class="tab hidden">
            <h3>Bot-Steuerung</h3>
            <p class="tabLead">WhatsApp-Bot kontrollieren und Laufzeitstatus live sehen.</p>
            <section class="sectionCard">
              <div class="row">
                <button id="botStartBtn">Start</button>
                <button id="botStopBtn" class="danger">Stopp</button>
                <button id="botRestartBtn">Neustart</button>
                <button id="botRefreshBtn">Status/Logs laden</button>
              </div>
            </section>
            <p id="botCtlMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="botStatusWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <div id="botLogsWrap" class="logsBox"></div>
            </section>
          </div>

          <div id="tab-botlookup" class="tab hidden">
            <h3>Empfänger-Check</h3>
            <p class="tabLead">Prüft schnell, ob ein Kontakt im System existiert, gebannt ist und wie der letzte Versandstatus aussieht.</p>
            <section class="sectionCard">
              <div class="row">
                <input id="botLookupPhoneInput" type="text" placeholder="Nummer, z. B. 4917612345678" />
                <button id="botLookupRunBtn">Prüfen</button>
              </div>
            </section>
            <p id="botLookupMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="botLookupStatsWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <div id="botLookupHistoryWrap" class="logsBox"></div>
            </section>
          </div>

          <div id="tab-appctl" class="tab hidden">
            <h3>App-Steuerung</h3>
            <p class="tabLead">Owner-App Prozess starten, stoppen, neustarten und Logs prüfen.</p>
            <section class="sectionCard">
              <div class="row">
                <button id="appStartBtn">Start</button>
                <button id="appStopBtn" class="danger">Stopp</button>
                <button id="appRestartBtn">Neustart</button>
                <button id="appRefreshBtn">Status/Logs laden</button>
              </div>
            </section>
            <p id="appCtlMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="appStatusWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <div id="appLogsWrap" class="logsBox"></div>
            </section>
          </div>

          <div id="tab-admin" class="tab hidden">
            <h3>Server-Steuerung</h3>
            <p class="tabLead">Server-Aktionen, Rollen, Jobs, Backups und Audits im Blick.</p>
            <section class="sectionCard">
              <div class="row">
                <button id="adminRefreshBtn">Status neu laden</button>
                <button id="adminRestartBotBtn">Bot neustarten</button>
                <button id="adminRestartAppBtn">App neustarten</button>
                <button id="adminRestartAllBtn">Alles neustarten</button>
                <button id="adminRestartServerBtn" class="danger">Server neustarten</button>
              </div>
            </section>
            <section class="sectionCard">
              <div class="row">
                <button id="adminAlertsRefreshBtn">Alerts laden</button>
                <button id="adminAuditRefreshBtn">Audit laden</button>
                <button id="adminUsersRefreshBtn">User laden</button>
                <button id="adminJobsRefreshBtn">Jobs laden</button>
              </div>
            </section>
            <p id="adminMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="adminStatusWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">Alerts</h4>
              <div id="adminAlertsWrap" class="infoBox"></div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">Feature Flags</h4>
              <div id="adminFlagsWrap" class="infoBox"></div>
              <div class="row">
                <button id="adminFlagsSaveBtn">Flags speichern</button>
              </div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">Job Queue</h4>
              <div class="row">
                <select id="adminJobOp">
                  <option value="restart_all">restart_all</option>
                  <option value="git_pull">git_pull</option>
                  <option value="deploy_now">deploy_now</option>
                  <option value="apk_build_debug">apk_build_debug</option>
                </select>
                <input id="adminJobRunAt" type="datetime-local" />
                <button id="adminJobCreateBtn">Job erstellen</button>
              </div>
              <div id="adminJobsWrap" class="tableWrap"></div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">Backup Manager</h4>
              <div class="row">
                <button id="adminBackupNowBtn">Backup jetzt</button>
                <button id="adminBackupCheckBtn">Integritätscheck</button>
                <button id="adminBackupListBtn">Backups laden</button>
              </div>
              <div id="adminBackupsWrap" class="tableWrap"></div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">Audit Log</h4>
              <div id="adminAuditWrap" class="tableWrap"></div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">User & Rollen</h4>
              <div class="row">
                <input id="adminRoleChatId" type="text" placeholder="chat_id" />
                <select id="adminRoleValue">
                  <option value="user">user</option>
                  <option value="admin">admin</option>
                  <option value="owner">owner</option>
                </select>
                <button id="adminRoleSetBtn">Rolle setzen</button>
              </div>
              <div id="adminUsersWrap" class="tableWrap"></div>
            </section>
          </div>

          <div id="tab-profile" class="tab hidden">
            <h3>Owner Profil</h3>
            <p class="tabLead">Profilansicht inklusive Avatar und persönlicher Biografie.</p>
            <section class="sectionCard">
              <div class="row">
                <button id="profileRefreshBtn">Profil laden</button>
                <button id="profileBioSaveBtn">Bio speichern</button>
                <button id="profileBioClearBtn" class="danger">Bio löschen</button>
              </div>
              <textarea id="profileBioInput" rows="3" placeholder="Eigene Profil-Biografie"></textarea>
            </section>
            <p id="profileMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="profileWrap" class="infoBox"></div>
            </section>
          </div>

          <div id="tab-info" class="tab hidden">
            <h3>Live Übersicht</h3>
            <p class="tabLead">Kompakte Live-Informationen zum Server, Bot und zur Owner-App.</p>
            <p id="infoMsg" class="msg"></p>
            <section class="sectionCard">
              <div id="infoBox" class="infoBox"></div>
            </section>
          </div>

          <div id="tab-forge" class="tab hidden">
            <h3>Command Forge</h3>
            <p class="tabLead">Automatisierte Abläufe für Diagnose, Neustart und Rollout-Checks.</p>
            <section class="sectionCard">
              <div class="row">
                <select id="forgePresetSelect">
                  <option value="heal_app">App-Heilung (Healthcheck -> Neustart -> Verifikation)</option>
                  <option value="full_smoke">System-Smoketest (Info, Prozesse, App-Meta, APK)</option>
                  <option value="safe_reboot">Sicherer Neustart (bot+app+checks)</option>
                </select>
                <button id="forgeLoadPresetBtn">Preset laden</button>
                <button id="forgeRunBtn">Workflow starten</button>
                <button id="forgeStopBtn" class="danger">Stopp</button>
              </div>
            </section>
            <section class="sectionCard">
              <label class="fieldLabel">Workflow JSON</label>
              <textarea id="forgeJsonInput" rows="12" spellcheck="false"></textarea>
            </section>
            <p id="forgeMsg" class="msg"></p>
            <section class="sectionCard">
              <h4 class="infoTitle">Ablauf</h4>
              <div id="forgeTimelineWrap" class="forgeTimeline"></div>
            </section>
            <section class="sectionCard">
              <h4 class="infoTitle">Ausgabe</h4>
              <div id="forgeLogsWrap" class="logsBox"></div>
            </section>
          </div>
        </main>
      </div>
    </section>
  </div>

  <script src="/app.js"></script>
</body>
</html>
